{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _Utils = require('./Utils');\n\nvar Utils = _interopRequireWildcard(_Utils);\n\nvar _CalendarHeader = require('./CalendarHeader');\n\nvar _CalendarHeader2 = _interopRequireDefault(_CalendarHeader);\n\nvar _CalendarBody = require('./CalendarBody');\n\nvar _CalendarBody2 = _interopRequireDefault(_CalendarBody);\n\nvar _ScaleColumn = require('./ScaleColumn');\n\nvar _ScaleColumn2 = _interopRequireDefault(_ScaleColumn);\n\nvar _HeaderCell = require('./HeaderCell');\n\nvar _HeaderCell2 = _interopRequireDefault(_HeaderCell);\n\nvar _DayCell = require('./DayCell');\n\nvar _DayCell2 = _interopRequireDefault(_DayCell);\n\nvar _Event = require('./Event');\n\nvar _Event2 = _interopRequireDefault(_Event);\n\nvar _Modal = require('./Modal');\n\nvar _Modal2 = _interopRequireDefault(_Modal);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar propTypes = {\n  firstDay: _propTypes2.default.object,\n  // the first day in the caledar\n  numberOfDays: _propTypes2.default.number,\n  scaleHeaderTitle: _propTypes2.default.string,\n  headerCellComponent: _propTypes2.default.func,\n  dayFormat: _propTypes2.default.string,\n  // header day format\n  startTime: _propTypes2.default.object,\n  // the start time of the scale and calendar\n  endTime: _propTypes2.default.object,\n  // the end time of the scale and calendar\n  scaleUnit: _propTypes2.default.number,\n  scaleFormat: _propTypes2.default.string,\n  cellHeight: _propTypes2.default.number,\n  dayCellComponent: _propTypes2.default.func,\n  selectedIntervals: _propTypes2.default.array,\n  onIntervalSelect: _propTypes2.default.func,\n  onIntervalUpdate: _propTypes2.default.func,\n  onIntervalRemove: _propTypes2.default.func,\n  eventComponent: _propTypes2.default.func,\n  onEventClick: _propTypes2.default.func,\n  modalComponent: _propTypes2.default.func,\n  useModal: _propTypes2.default.bool,\n  showModalCase: _propTypes2.default.arrayOf(_propTypes2.default.string),\n  eventSpacing: _propTypes2.default.number\n};\nvar defaultProps = {\n  firstDay: (0, _moment2.default)(),\n  numberOfDays: 7,\n  scaleHeaderTitle: '',\n  headerCellComponent: _HeaderCell2.default,\n  dayFormat: 'dd., DD.MM',\n  startTime: (0, _moment2.default)({\n    h: 0,\n    m: 0\n  }),\n  endTime: (0, _moment2.default)({\n    h: 23,\n    m: 59\n  }),\n  scaleUnit: 15,\n  scaleFormat: 'HH:mm',\n  cellHeight: 25,\n  dayCellComponent: _DayCell2.default,\n  selectedIntervals: [],\n  eventComponent: _Event2.default,\n  modalComponent: _Modal2.default,\n  useModal: true,\n  showModalCase: [_constants.ACTION_TYPES.CREATE, _constants.ACTION_TYPES.EDIT],\n  eventSpacing: 15\n};\n\nvar WeekCalendar = function (_React$Component) {\n  _inherits(WeekCalendar, _React$Component);\n\n  function WeekCalendar(props) {\n    _classCallCheck(this, WeekCalendar);\n\n    var _this = _possibleConstructorReturn(this, (WeekCalendar.__proto__ || Object.getPrototypeOf(WeekCalendar)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var scaleUnit = props.scaleUnit,\n        startTime = props.startTime,\n        endTime = props.endTime;\n    var scaleIntervals = Utils.getIntervalsByDuration(scaleUnit, startTime, endTime);\n    _this.state = {\n      scaleIntervals: scaleIntervals,\n      columnDimensions: [],\n      scrollPosition: {\n        top: 0,\n        left: 0\n      },\n      startSelectionPosition: null,\n      preselectedInterval: null\n    };\n    return _this;\n  }\n\n  _createClass(WeekCalendar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.calculateColumnDimension();\n      window.addEventListener('resize', this.calculateColumnDimension);\n      window.addEventListener('mouseup', this.handleSelectionStop);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.scaleUnit !== this.props.scaleUnit || nextProps.startTime !== this.props.startTime || nextProps.endTime !== this.props.endTime) {\n        var scaleIntervals = Utils.getIntervalsByDuration(nextProps.scaleUnit, nextProps.startTime, nextProps.endTime);\n        this.setState({\n          scaleIntervals: scaleIntervals\n        });\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.calculateColumnDimension);\n      window.removeEventListener('mouseup', this.handleSelectionStop);\n    }\n  }, {\n    key: 'renderSelectedIntervals',\n    value: function renderSelectedIntervals() {\n      var _this2 = this;\n\n      var _props = this.props,\n          firstDay = _props.firstDay,\n          numberOfDays = _props.numberOfDays,\n          cellHeight = _props.cellHeight,\n          scaleUnit = _props.scaleUnit,\n          selectedIntervals = _props.selectedIntervals,\n          eventSpacing = _props.eventSpacing;\n      var _state = this.state,\n          columnDimensions = _state.columnDimensions,\n          scaleIntervals = _state.scaleIntervals;\n      var result = [];\n\n      if (columnDimensions.length === 0 || selectedIntervals.length === 0) {\n        return result;\n      }\n\n      var EventComponent = this.props.eventComponent;\n      var offsetTop = Utils.getOffset(scaleIntervals[0].start);\n\n      var _loop = function _loop(dayIndex) {\n        var day = (0, _moment2.default)(firstDay).startOf('day').add(dayIndex, 'day');\n        var intervals = selectedIntervals.filter(function (interval) {\n          return interval.start.isSame(day, 'day') || interval.end.isSame(day, 'day');\n        });\n\n        if (intervals.length > 0) {\n          intervals.sort(function (i1, i2) {\n            return i1.start.diff(i2.start, 'minutes');\n          });\n          intervals.forEach(function (interval, index, array) {\n            var startY = 0;\n\n            if (!interval.start.isBefore(day)) {\n              startY = Utils.getNumberOfCells(interval.start, scaleUnit, false, offsetTop);\n            }\n\n            if (startY > scaleIntervals.length) {\n              return;\n            }\n\n            var beforeIntersectionNumber = array.filter(function (i, i1) {\n              return i1 < index && interval.start.isBefore(i.end);\n            }).length;\n            var afterIntersectionNumber = array.filter(function (i, i1) {\n              return i1 > index && interval.end.isAfter(i.start);\n            }).length;\n            var groupIntersection = beforeIntersectionNumber + afterIntersectionNumber + 1;\n            var endY = Utils.getNumberOfCells(interval.end, scaleUnit, true, offsetTop);\n\n            if (endY > scaleIntervals.length) {\n              endY = scaleIntervals.length;\n            }\n\n            var top = startY * cellHeight;\n            var width = (columnDimensions[dayIndex].width - eventSpacing) / groupIntersection; // TODO: dividing  by the GroupIntersection doesn't seem to work all that great...\n\n            var left = columnDimensions[dayIndex].left + (width + Math.floor(eventSpacing / groupIntersection)) * beforeIntersectionNumber;\n            var height = (endY - startY) * cellHeight;\n            var eventWrapperStyle = {\n              top: top,\n              left: left,\n              width: width,\n              height: height\n            };\n\n            var eventComponent = _react2.default.createElement('div', {\n              className: 'weekCalendar__overlay',\n              key: dayIndex * 20000 + index,\n              style: eventWrapperStyle,\n              onClick: _this2.handleEventClick.bind(_this2, interval)\n            }, _react2.default.createElement(EventComponent, interval));\n\n            result.push(eventComponent);\n          });\n        }\n      };\n\n      for (var dayIndex = 0; dayIndex < numberOfDays; dayIndex += 1) {\n        _loop(dayIndex);\n      }\n\n      return result;\n    }\n  }, {\n    key: 'renderOverlay',\n    value: function renderOverlay() {\n      if (this.state.startSelectionPosition != null) {\n        var startPosition = this.state.startSelectionPosition;\n        var mousePosition = this.state.mousePosition;\n        var top = Math.min(startPosition.y, mousePosition.y) * this.props.cellHeight;\n        var left = this.state.columnDimensions[Math.min(startPosition.x, mousePosition.x)].left;\n        var lastSelectedColumn = this.state.columnDimensions[Math.max(startPosition.x, mousePosition.x)];\n        var width = lastSelectedColumn.left - left + lastSelectedColumn.width;\n        var height = (Math.max(startPosition.y, mousePosition.y) + 1) * this.props.cellHeight - top;\n        var overlayStyle = {\n          top: top,\n          left: left,\n          width: width,\n          height: height\n        };\n        return _react2.default.createElement('div', {\n          className: 'weekCalendar__overlay weekCalendar__overlay_status_selection',\n          style: overlayStyle\n        });\n      }\n\n      return null;\n    }\n  }, {\n    key: 'renderModal',\n    value: function renderModal() {\n      var _props2 = this.props,\n          useModal = _props2.useModal,\n          showModalCase = _props2.showModalCase;\n      var _state2 = this.state,\n          preselectedInterval = _state2.preselectedInterval,\n          updateEvent = _state2.updateEvent;\n      var currentCase = updateEvent ? _constants.ACTION_TYPES.EDIT : _constants.ACTION_TYPES.CREATE;\n      var shouldRenderModal = preselectedInterval && useModal && showModalCase.includes(currentCase);\n\n      if (shouldRenderModal) {\n        var ModalComponent = this.props.modalComponent;\n        return _react2.default.createElement('div', {\n          className: 'calendarModal'\n        }, _react2.default.createElement('div', {\n          className: 'calendarModal__backdrop',\n          onClick: this.closeModule\n        }), _react2.default.createElement('div', {\n          className: 'calendarModal__content'\n        }, _react2.default.createElement(ModalComponent, _extends({}, preselectedInterval, {\n          onRemove: this.removePreselectedInterval,\n          onSave: this.submitPreselectedInterval,\n          actionType: currentCase\n        }))));\n      }\n\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          firstDay = _props3.firstDay,\n          numberOfDays = _props3.numberOfDays,\n          headerCellComponent = _props3.headerCellComponent,\n          dayFormat = _props3.dayFormat,\n          scaleUnit = _props3.scaleUnit,\n          scaleFormat = _props3.scaleFormat,\n          cellHeight = _props3.cellHeight,\n          dayCellComponent = _props3.dayCellComponent,\n          scaleHeaderTitle = _props3.scaleHeaderTitle;\n      var isSelection = this.state.startSelectionPosition != null;\n      return _react2.default.createElement('div', {\n        className: isSelection ? 'weekCalendar weekCalendar__status_selection' : 'weekCalendar'\n      }, _react2.default.createElement('div', {\n        className: 'weekCalendar__scaleHeader'\n      }, _react2.default.createElement('span', null, scaleHeaderTitle)), _react2.default.createElement('div', {\n        className: 'weekCalendar__header',\n        style: {\n          left: -this.state.scrollPosition.left\n        }\n      }, _react2.default.createElement(_CalendarHeader2.default, {\n        firstDay: firstDay,\n        numberOfDays: numberOfDays,\n        dayFormat: dayFormat,\n        columnDimensions: this.state.columnDimensions,\n        headerCellComponent: headerCellComponent\n      })), _react2.default.createElement('div', {\n        className: 'weekCalendar__scaleColumn',\n        style: {\n          top: -this.state.scrollPosition.top\n        }\n      }, _react2.default.createElement(_ScaleColumn2.default, {\n        scaleUnit: this.props.scaleUnit,\n        scaleFormat: scaleFormat,\n        scaleIntervals: this.state.scaleIntervals,\n        cellHeight: this.props.cellHeight\n      })), _react2.default.createElement('div', {\n        className: 'weekCalendar__content',\n        onScroll: this.handleScroll\n      }, _react2.default.createElement(_CalendarBody2.default, {\n        firstDay: firstDay,\n        numberOfDays: numberOfDays,\n        scaleUnit: scaleUnit,\n        scaleIntervals: this.state.scaleIntervals,\n        cellHeight: cellHeight,\n        dayCellComponent: dayCellComponent,\n        onSelectionStart: this.handleSelectionStart,\n        onCellMouseEnter: this.handleCellMouseEnter\n      }), this.renderSelectedIntervals(), this.renderOverlay()), this.renderModal());\n    }\n  }]);\n\n  return WeekCalendar;\n}(_react2.default.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.calculateColumnDimension = function () {\n    var numberOfDays = _this3.props.numberOfDays;\n    var columnDimensions = [];\n\n    for (var i = 0; i < numberOfDays; i += 1) {\n      var left = i === 0 ? 0 : columnDimensions[i - 1].left + columnDimensions[i - 1].width;\n      var columnWidth = 0;\n      var columnElement = document.querySelectorAll('[data-colpos=\\'' + i + '\\']')[0];\n\n      if (columnElement) {\n        columnWidth = columnElement.getBoundingClientRect().width;\n      }\n\n      columnDimensions.push({\n        left: left,\n        width: columnWidth\n      });\n    }\n\n    _this3.setState({\n      columnDimensions: columnDimensions\n    });\n  };\n\n  this.handleScroll = function (e) {\n    _this3.setState({\n      scrollPosition: {\n        top: e.target.scrollTop,\n        left: e.target.scrollLeft\n      }\n    });\n  };\n\n  this.handleCellMouseEnter = function (col, row) {\n    if (_this3.state.startSelectionPosition != null) {\n      _this3.setState({\n        mousePosition: {\n          x: col,\n          y: row\n        }\n      });\n    }\n  };\n\n  this.handleSelectionStart = function (col, row) {\n    var startSelectionPosition = {\n      x: col,\n      y: row\n    };\n\n    _this3.setState({\n      startSelectionPosition: startSelectionPosition,\n      mousePosition: startSelectionPosition\n    });\n  };\n\n  this.handleSelectionStop = function (e) {\n    if (e.button !== 0) {\n      return;\n    }\n\n    var _props4 = _this3.props,\n        firstDay = _props4.firstDay,\n        scaleUnit = _props4.scaleUnit,\n        useModal = _props4.useModal,\n        showModalCase = _props4.showModalCase;\n    var _state3 = _this3.state,\n        startSelectionPosition = _state3.startSelectionPosition,\n        mousePosition = _state3.mousePosition,\n        scaleIntervals = _state3.scaleIntervals;\n\n    if (startSelectionPosition == null) {\n      return;\n    }\n\n    var endCol = mousePosition.x;\n    var endRow = mousePosition.y;\n    var minDayIndex = Math.min(startSelectionPosition.x, endCol);\n    var maxDayIndex = Math.max(startSelectionPosition.x, endCol);\n    var startDay = (0, _moment2.default)(firstDay).add(minDayIndex, 'days');\n    var endDay = (0, _moment2.default)(firstDay).add(maxDayIndex, 'days');\n    var minCellIndex = Math.min(startSelectionPosition.y, endRow);\n    var maxCellIndex = Math.max(startSelectionPosition.y, endRow) + 1;\n    var offsetTop = Utils.getOffset(scaleIntervals[0].start);\n    var startSelectionTime = Utils.getMoment(scaleUnit, minCellIndex, offsetTop);\n    var endSelectionTime = Utils.getMoment(scaleUnit, maxCellIndex, offsetTop);\n    var start = (0, _moment2.default)(startDay).hour(startSelectionTime.hour()).minute(startSelectionTime.minute()).second(0);\n    var end = (0, _moment2.default)(endDay).hour(endSelectionTime.hour()).minute(endSelectionTime.minute()).second(0);\n\n    if (useModal && showModalCase.includes(_constants.ACTION_TYPES.CREATE)) {\n      var preselectedInterval = {\n        start: start,\n        end: end\n      };\n\n      _this3.setState({\n        preselectedInterval: preselectedInterval,\n        updateEvent: false\n      });\n    } else {\n      var result = Utils.getIntervals(start, end);\n\n      if (_this3.props.onIntervalSelect) {\n        _this3.props.onIntervalSelect(result);\n      }\n    }\n\n    _this3.setState({\n      startSelectionPosition: null,\n      mousePosition: null\n    });\n  };\n\n  this.removePreselectedInterval = function () {\n    var _state4 = _this3.state,\n        preselectedInterval = _state4.preselectedInterval,\n        updateEvent = _state4.updateEvent;\n\n    if (updateEvent && _this3.props.onIntervalRemove) {\n      _this3.props.onIntervalRemove(preselectedInterval);\n    }\n\n    _this3.setState({\n      preselectedInterval: null\n    });\n  };\n\n  this.submitPreselectedInterval = function (newValue) {\n    var _state5 = _this3.state,\n        preselectedInterval = _state5.preselectedInterval,\n        updateEvent = _state5.updateEvent;\n\n    if (updateEvent) {\n      if (_this3.props.onIntervalUpdate) {\n        _this3.props.onIntervalUpdate(_extends({}, preselectedInterval, newValue));\n      }\n    } else if (_this3.props.onIntervalSelect) {\n      var _intervals = Utils.getIntervals(preselectedInterval.start, preselectedInterval.end);\n\n      var result = _intervals.map(function (interval) {\n        return _extends({}, interval, newValue);\n      });\n\n      _this3.props.onIntervalSelect(result);\n    }\n\n    _this3.setState({\n      preselectedInterval: null\n    });\n  };\n\n  this.closeModule = function () {\n    _this3.setState({\n      preselectedInterval: null\n    });\n  };\n\n  this.handleEventClick = function (oEvent) {\n    if (_this3.props.onEventClick) {\n      _this3.props.onEventClick(oEvent);\n    }\n\n    _this3.setState({\n      preselectedInterval: oEvent,\n      updateEvent: true\n    });\n  };\n};\n\nWeekCalendar.propTypes = propTypes;\nWeekCalendar.defaultProps = defaultProps;\nexports.default = WeekCalendar;","map":{"version":3,"sources":["/home/ubuntu/THREATcrawl/threatcrawl/node_modules/react-week-calendar/dist/WeekCalendar.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_propTypes","_propTypes2","_moment","_moment2","_Utils","Utils","_interopRequireWildcard","_CalendarHeader","_CalendarHeader2","_CalendarBody","_CalendarBody2","_ScaleColumn","_ScaleColumn2","_HeaderCell","_HeaderCell2","_DayCell","_DayCell2","_Event","_Event2","_Modal","_Modal2","_constants","obj","__esModule","newObj","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","propTypes","firstDay","object","numberOfDays","number","scaleHeaderTitle","string","headerCellComponent","func","dayFormat","startTime","endTime","scaleUnit","scaleFormat","cellHeight","dayCellComponent","selectedIntervals","array","onIntervalSelect","onIntervalUpdate","onIntervalRemove","eventComponent","onEventClick","modalComponent","useModal","bool","showModalCase","arrayOf","eventSpacing","defaultProps","h","m","ACTION_TYPES","CREATE","EDIT","WeekCalendar","_React$Component","_this","getPrototypeOf","_initialiseProps","scaleIntervals","getIntervalsByDuration","state","columnDimensions","scrollPosition","top","left","startSelectionPosition","preselectedInterval","componentDidMount","calculateColumnDimension","window","addEventListener","handleSelectionStop","componentWillReceiveProps","nextProps","setState","componentWillUnmount","removeEventListener","renderSelectedIntervals","_this2","_props","_state","result","EventComponent","offsetTop","getOffset","start","_loop","dayIndex","day","startOf","add","intervals","filter","interval","isSame","end","sort","i1","i2","diff","forEach","index","startY","isBefore","getNumberOfCells","beforeIntersectionNumber","afterIntersectionNumber","isAfter","groupIntersection","endY","width","Math","floor","height","eventWrapperStyle","createElement","className","style","onClick","handleEventClick","bind","push","renderOverlay","startPosition","mousePosition","min","y","x","lastSelectedColumn","max","overlayStyle","renderModal","_props2","_state2","updateEvent","currentCase","shouldRenderModal","includes","ModalComponent","closeModule","onRemove","removePreselectedInterval","onSave","submitPreselectedInterval","actionType","render","_props3","isSelection","onScroll","handleScroll","onSelectionStart","handleSelectionStart","onCellMouseEnter","handleCellMouseEnter","Component","_this3","columnWidth","columnElement","document","querySelectorAll","getBoundingClientRect","e","scrollTop","scrollLeft","col","row","button","_props4","_state3","endCol","endRow","minDayIndex","maxDayIndex","startDay","endDay","minCellIndex","maxCellIndex","startSelectionTime","getMoment","endSelectionTime","hour","minute","second","getIntervals","_state4","newValue","_state5","_intervals","map","oEvent"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _Utils = require('./Utils');\n\nvar Utils = _interopRequireWildcard(_Utils);\n\nvar _CalendarHeader = require('./CalendarHeader');\n\nvar _CalendarHeader2 = _interopRequireDefault(_CalendarHeader);\n\nvar _CalendarBody = require('./CalendarBody');\n\nvar _CalendarBody2 = _interopRequireDefault(_CalendarBody);\n\nvar _ScaleColumn = require('./ScaleColumn');\n\nvar _ScaleColumn2 = _interopRequireDefault(_ScaleColumn);\n\nvar _HeaderCell = require('./HeaderCell');\n\nvar _HeaderCell2 = _interopRequireDefault(_HeaderCell);\n\nvar _DayCell = require('./DayCell');\n\nvar _DayCell2 = _interopRequireDefault(_DayCell);\n\nvar _Event = require('./Event');\n\nvar _Event2 = _interopRequireDefault(_Event);\n\nvar _Modal = require('./Modal');\n\nvar _Modal2 = _interopRequireDefault(_Modal);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar propTypes = {\n  firstDay: _propTypes2.default.object, // the first day in the caledar\n  numberOfDays: _propTypes2.default.number,\n  scaleHeaderTitle: _propTypes2.default.string,\n  headerCellComponent: _propTypes2.default.func,\n  dayFormat: _propTypes2.default.string, // header day format\n\n  startTime: _propTypes2.default.object, // the start time of the scale and calendar\n  endTime: _propTypes2.default.object, // the end time of the scale and calendar\n  scaleUnit: _propTypes2.default.number,\n  scaleFormat: _propTypes2.default.string,\n  cellHeight: _propTypes2.default.number,\n  dayCellComponent: _propTypes2.default.func,\n\n  selectedIntervals: _propTypes2.default.array,\n  onIntervalSelect: _propTypes2.default.func,\n  onIntervalUpdate: _propTypes2.default.func,\n  onIntervalRemove: _propTypes2.default.func,\n\n  eventComponent: _propTypes2.default.func,\n  onEventClick: _propTypes2.default.func,\n\n  modalComponent: _propTypes2.default.func,\n  useModal: _propTypes2.default.bool,\n  showModalCase: _propTypes2.default.arrayOf(_propTypes2.default.string),\n  eventSpacing: _propTypes2.default.number\n};\n\nvar defaultProps = {\n  firstDay: (0, _moment2.default)(),\n  numberOfDays: 7,\n  scaleHeaderTitle: '',\n  headerCellComponent: _HeaderCell2.default,\n  dayFormat: 'dd., DD.MM',\n  startTime: (0, _moment2.default)({ h: 0, m: 0 }),\n  endTime: (0, _moment2.default)({ h: 23, m: 59 }),\n  scaleUnit: 15,\n  scaleFormat: 'HH:mm',\n  cellHeight: 25,\n  dayCellComponent: _DayCell2.default,\n  selectedIntervals: [],\n  eventComponent: _Event2.default,\n  modalComponent: _Modal2.default,\n  useModal: true,\n  showModalCase: [_constants.ACTION_TYPES.CREATE, _constants.ACTION_TYPES.EDIT],\n  eventSpacing: 15\n};\n\nvar WeekCalendar = function (_React$Component) {\n  _inherits(WeekCalendar, _React$Component);\n\n  function WeekCalendar(props) {\n    _classCallCheck(this, WeekCalendar);\n\n    var _this = _possibleConstructorReturn(this, (WeekCalendar.__proto__ || Object.getPrototypeOf(WeekCalendar)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var scaleUnit = props.scaleUnit,\n        startTime = props.startTime,\n        endTime = props.endTime;\n\n    var scaleIntervals = Utils.getIntervalsByDuration(scaleUnit, startTime, endTime);\n\n    _this.state = {\n      scaleIntervals: scaleIntervals,\n      columnDimensions: [],\n      scrollPosition: {\n        top: 0,\n        left: 0\n      },\n      startSelectionPosition: null,\n      preselectedInterval: null\n    };\n    return _this;\n  }\n\n  _createClass(WeekCalendar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.calculateColumnDimension();\n      window.addEventListener('resize', this.calculateColumnDimension);\n      window.addEventListener('mouseup', this.handleSelectionStop);\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.scaleUnit !== this.props.scaleUnit || nextProps.startTime !== this.props.startTime || nextProps.endTime !== this.props.endTime) {\n        var scaleIntervals = Utils.getIntervalsByDuration(nextProps.scaleUnit, nextProps.startTime, nextProps.endTime);\n        this.setState({\n          scaleIntervals: scaleIntervals\n        });\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.calculateColumnDimension);\n      window.removeEventListener('mouseup', this.handleSelectionStop);\n    }\n  }, {\n    key: 'renderSelectedIntervals',\n    value: function renderSelectedIntervals() {\n      var _this2 = this;\n\n      var _props = this.props,\n          firstDay = _props.firstDay,\n          numberOfDays = _props.numberOfDays,\n          cellHeight = _props.cellHeight,\n          scaleUnit = _props.scaleUnit,\n          selectedIntervals = _props.selectedIntervals,\n          eventSpacing = _props.eventSpacing;\n      var _state = this.state,\n          columnDimensions = _state.columnDimensions,\n          scaleIntervals = _state.scaleIntervals;\n\n      var result = [];\n      if (columnDimensions.length === 0 || selectedIntervals.length === 0) {\n        return result;\n      }\n      var EventComponent = this.props.eventComponent;\n      var offsetTop = Utils.getOffset(scaleIntervals[0].start);\n\n      var _loop = function _loop(dayIndex) {\n        var day = (0, _moment2.default)(firstDay).startOf('day').add(dayIndex, 'day');\n        var intervals = selectedIntervals.filter(function (interval) {\n          return interval.start.isSame(day, 'day') || interval.end.isSame(day, 'day');\n        });\n        if (intervals.length > 0) {\n          intervals.sort(function (i1, i2) {\n            return i1.start.diff(i2.start, 'minutes');\n          });\n\n          intervals.forEach(function (interval, index, array) {\n            var startY = 0;\n            if (!interval.start.isBefore(day)) {\n              startY = Utils.getNumberOfCells(interval.start, scaleUnit, false, offsetTop);\n            }\n\n            if (startY > scaleIntervals.length) {\n              return;\n            }\n\n            var beforeIntersectionNumber = array.filter(function (i, i1) {\n              return i1 < index && interval.start.isBefore(i.end);\n            }).length;\n            var afterIntersectionNumber = array.filter(function (i, i1) {\n              return i1 > index && interval.end.isAfter(i.start);\n            }).length;\n            var groupIntersection = beforeIntersectionNumber + afterIntersectionNumber + 1;\n\n            var endY = Utils.getNumberOfCells(interval.end, scaleUnit, true, offsetTop);\n            if (endY > scaleIntervals.length) {\n              endY = scaleIntervals.length;\n            }\n            var top = startY * cellHeight;\n            var width = (columnDimensions[dayIndex].width - eventSpacing) / groupIntersection;\n\n            // TODO: dividing  by the GroupIntersection doesn't seem to work all that great...\n            var left = columnDimensions[dayIndex].left + (width + Math.floor(eventSpacing / groupIntersection)) * beforeIntersectionNumber;\n            var height = (endY - startY) * cellHeight;\n            var eventWrapperStyle = {\n              top: top,\n              left: left,\n              width: width,\n              height: height\n            };\n            var eventComponent = _react2.default.createElement(\n              'div',\n              {\n                className: 'weekCalendar__overlay',\n                key: dayIndex * 20000 + index,\n                style: eventWrapperStyle,\n                onClick: _this2.handleEventClick.bind(_this2, interval)\n              },\n              _react2.default.createElement(EventComponent, interval)\n            );\n            result.push(eventComponent);\n          });\n        }\n      };\n\n      for (var dayIndex = 0; dayIndex < numberOfDays; dayIndex += 1) {\n        _loop(dayIndex);\n      }\n      return result;\n    }\n  }, {\n    key: 'renderOverlay',\n    value: function renderOverlay() {\n      if (this.state.startSelectionPosition != null) {\n        var startPosition = this.state.startSelectionPosition;\n        var mousePosition = this.state.mousePosition;\n\n\n        var top = Math.min(startPosition.y, mousePosition.y) * this.props.cellHeight;\n        var left = this.state.columnDimensions[Math.min(startPosition.x, mousePosition.x)].left;\n\n        var lastSelectedColumn = this.state.columnDimensions[Math.max(startPosition.x, mousePosition.x)];\n        var width = lastSelectedColumn.left - left + lastSelectedColumn.width;\n        var height = (Math.max(startPosition.y, mousePosition.y) + 1) * this.props.cellHeight - top;\n        var overlayStyle = {\n          top: top,\n          left: left,\n          width: width,\n          height: height\n        };\n        return _react2.default.createElement('div', {\n          className: 'weekCalendar__overlay weekCalendar__overlay_status_selection',\n          style: overlayStyle\n        });\n      }\n      return null;\n    }\n  }, {\n    key: 'renderModal',\n    value: function renderModal() {\n      var _props2 = this.props,\n          useModal = _props2.useModal,\n          showModalCase = _props2.showModalCase;\n      var _state2 = this.state,\n          preselectedInterval = _state2.preselectedInterval,\n          updateEvent = _state2.updateEvent;\n\n      var currentCase = updateEvent ? _constants.ACTION_TYPES.EDIT : _constants.ACTION_TYPES.CREATE;\n      var shouldRenderModal = preselectedInterval && useModal && showModalCase.includes(currentCase);\n\n      if (shouldRenderModal) {\n        var ModalComponent = this.props.modalComponent;\n        return _react2.default.createElement(\n          'div',\n          { className: 'calendarModal' },\n          _react2.default.createElement('div', { className: 'calendarModal__backdrop', onClick: this.closeModule }),\n          _react2.default.createElement(\n            'div',\n            { className: 'calendarModal__content' },\n            _react2.default.createElement(ModalComponent, _extends({}, preselectedInterval, {\n              onRemove: this.removePreselectedInterval,\n              onSave: this.submitPreselectedInterval,\n              actionType: currentCase\n            }))\n          )\n        );\n      }\n\n      return null;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props3 = this.props,\n          firstDay = _props3.firstDay,\n          numberOfDays = _props3.numberOfDays,\n          headerCellComponent = _props3.headerCellComponent,\n          dayFormat = _props3.dayFormat,\n          scaleUnit = _props3.scaleUnit,\n          scaleFormat = _props3.scaleFormat,\n          cellHeight = _props3.cellHeight,\n          dayCellComponent = _props3.dayCellComponent,\n          scaleHeaderTitle = _props3.scaleHeaderTitle;\n\n\n      var isSelection = this.state.startSelectionPosition != null;\n\n      return _react2.default.createElement(\n        'div',\n        { className: isSelection ? 'weekCalendar weekCalendar__status_selection' : 'weekCalendar' },\n        _react2.default.createElement(\n          'div',\n          { className: 'weekCalendar__scaleHeader' },\n          _react2.default.createElement(\n            'span',\n            null,\n            scaleHeaderTitle\n          )\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'weekCalendar__header', style: { left: -this.state.scrollPosition.left } },\n          _react2.default.createElement(_CalendarHeader2.default, {\n            firstDay: firstDay,\n            numberOfDays: numberOfDays,\n            dayFormat: dayFormat,\n            columnDimensions: this.state.columnDimensions,\n            headerCellComponent: headerCellComponent\n          })\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'weekCalendar__scaleColumn', style: { top: -this.state.scrollPosition.top } },\n          _react2.default.createElement(_ScaleColumn2.default, {\n            scaleUnit: this.props.scaleUnit,\n            scaleFormat: scaleFormat,\n            scaleIntervals: this.state.scaleIntervals,\n            cellHeight: this.props.cellHeight\n          })\n        ),\n        _react2.default.createElement(\n          'div',\n          { className: 'weekCalendar__content', onScroll: this.handleScroll },\n          _react2.default.createElement(_CalendarBody2.default, {\n            firstDay: firstDay,\n            numberOfDays: numberOfDays,\n            scaleUnit: scaleUnit,\n            scaleIntervals: this.state.scaleIntervals,\n            cellHeight: cellHeight,\n            dayCellComponent: dayCellComponent,\n            onSelectionStart: this.handleSelectionStart,\n            onCellMouseEnter: this.handleCellMouseEnter\n          }),\n          this.renderSelectedIntervals(),\n          this.renderOverlay()\n        ),\n        this.renderModal()\n      );\n    }\n  }]);\n\n  return WeekCalendar;\n}(_react2.default.Component);\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.calculateColumnDimension = function () {\n    var numberOfDays = _this3.props.numberOfDays;\n\n    var columnDimensions = [];\n    for (var i = 0; i < numberOfDays; i += 1) {\n      var left = i === 0 ? 0 : columnDimensions[i - 1].left + columnDimensions[i - 1].width;\n      var columnWidth = 0;\n\n      var columnElement = document.querySelectorAll('[data-colpos=\\'' + i + '\\']')[0];\n      if (columnElement) {\n        columnWidth = columnElement.getBoundingClientRect().width;\n      }\n      columnDimensions.push({\n        left: left,\n        width: columnWidth\n      });\n    }\n    _this3.setState({ columnDimensions: columnDimensions });\n  };\n\n  this.handleScroll = function (e) {\n    _this3.setState({\n      scrollPosition: {\n        top: e.target.scrollTop,\n        left: e.target.scrollLeft\n      }\n    });\n  };\n\n  this.handleCellMouseEnter = function (col, row) {\n    if (_this3.state.startSelectionPosition != null) {\n      _this3.setState({\n        mousePosition: {\n          x: col,\n          y: row\n        }\n      });\n    }\n  };\n\n  this.handleSelectionStart = function (col, row) {\n    var startSelectionPosition = {\n      x: col,\n      y: row\n    };\n    _this3.setState({\n      startSelectionPosition: startSelectionPosition,\n      mousePosition: startSelectionPosition\n    });\n  };\n\n  this.handleSelectionStop = function (e) {\n    if (e.button !== 0) {\n      return;\n    }\n\n    var _props4 = _this3.props,\n        firstDay = _props4.firstDay,\n        scaleUnit = _props4.scaleUnit,\n        useModal = _props4.useModal,\n        showModalCase = _props4.showModalCase;\n    var _state3 = _this3.state,\n        startSelectionPosition = _state3.startSelectionPosition,\n        mousePosition = _state3.mousePosition,\n        scaleIntervals = _state3.scaleIntervals;\n\n\n    if (startSelectionPosition == null) {\n      return;\n    }\n\n    var endCol = mousePosition.x;\n    var endRow = mousePosition.y;\n\n    var minDayIndex = Math.min(startSelectionPosition.x, endCol);\n    var maxDayIndex = Math.max(startSelectionPosition.x, endCol);\n\n    var startDay = (0, _moment2.default)(firstDay).add(minDayIndex, 'days');\n    var endDay = (0, _moment2.default)(firstDay).add(maxDayIndex, 'days');\n\n    var minCellIndex = Math.min(startSelectionPosition.y, endRow);\n    var maxCellIndex = Math.max(startSelectionPosition.y, endRow) + 1;\n    var offsetTop = Utils.getOffset(scaleIntervals[0].start);\n    var startSelectionTime = Utils.getMoment(scaleUnit, minCellIndex, offsetTop);\n    var endSelectionTime = Utils.getMoment(scaleUnit, maxCellIndex, offsetTop);\n\n    var start = (0, _moment2.default)(startDay).hour(startSelectionTime.hour()).minute(startSelectionTime.minute()).second(0);\n    var end = (0, _moment2.default)(endDay).hour(endSelectionTime.hour()).minute(endSelectionTime.minute()).second(0);\n\n    if (useModal && showModalCase.includes(_constants.ACTION_TYPES.CREATE)) {\n      var preselectedInterval = {\n        start: start,\n        end: end\n      };\n      _this3.setState({\n        preselectedInterval: preselectedInterval,\n        updateEvent: false\n      });\n    } else {\n      var result = Utils.getIntervals(start, end);\n      if (_this3.props.onIntervalSelect) {\n        _this3.props.onIntervalSelect(result);\n      }\n    }\n\n    _this3.setState({\n      startSelectionPosition: null,\n      mousePosition: null\n    });\n  };\n\n  this.removePreselectedInterval = function () {\n    var _state4 = _this3.state,\n        preselectedInterval = _state4.preselectedInterval,\n        updateEvent = _state4.updateEvent;\n\n    if (updateEvent && _this3.props.onIntervalRemove) {\n      _this3.props.onIntervalRemove(preselectedInterval);\n    }\n    _this3.setState({ preselectedInterval: null });\n  };\n\n  this.submitPreselectedInterval = function (newValue) {\n    var _state5 = _this3.state,\n        preselectedInterval = _state5.preselectedInterval,\n        updateEvent = _state5.updateEvent;\n\n\n    if (updateEvent) {\n      if (_this3.props.onIntervalUpdate) {\n        _this3.props.onIntervalUpdate(_extends({}, preselectedInterval, newValue));\n      }\n    } else if (_this3.props.onIntervalSelect) {\n      var _intervals = Utils.getIntervals(preselectedInterval.start, preselectedInterval.end);\n      var result = _intervals.map(function (interval) {\n        return _extends({}, interval, newValue);\n      });\n      _this3.props.onIntervalSelect(result);\n    }\n\n    _this3.setState({ preselectedInterval: null });\n  };\n\n  this.closeModule = function () {\n    _this3.setState({\n      preselectedInterval: null\n    });\n  };\n\n  this.handleEventClick = function (oEvent) {\n    if (_this3.props.onEventClick) {\n      _this3.props.onEventClick(oEvent);\n    }\n    _this3.setState({\n      preselectedInterval: oEvent,\n      updateEvent: true\n    });\n  };\n};\n\nWeekCalendar.propTypes = propTypes;\nWeekCalendar.defaultProps = defaultProps;\n\nexports.default = WeekCalendar;"]},"metadata":{},"sourceType":"script"}